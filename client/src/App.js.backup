import React, { useState, useEffect } from "react";
import "./App_professional.css";
import "./PremiumMobile.css";
import Chatbot from "./Chatbot";
import Admin from "./Admin";
import WalmartChatbot from "./WalmartChatbot";
import EnhancedChatbot from "./EnhancedChatbot";
import WalmartAdmin from "./WalmartAdmin";
import ConnectionTest from "./ConnectionTest";
import AnalyticsDashboard from "./AnalyticsDashboard";
import EnhancedAnalyticsDashboard from "./EnhancedAnalyticsDashboard";
import AdvancedSearch from "./AdvancedSearch";
import MiniSearch from "./MiniSearch";
import SmartShoppingCart            <h3 className="tech-showcase-title">üöÄ Advanced Technology Features</h3>from "./SmartShoppingCart";
import DeliveryAnimation from "./DeliveryAnimation";
import EnhancedARViewer from "./EnhancedARViewer_New";
import VirtualARTryOn from "./VirtualARTryOn";
import ARProductsShowcase from "./ARProductsShowcase";
import Footer from "./Footer";
import MobileHeader from "./MobileHeader";
import MobileNavigation from "./MobileNavigation";
import PremiumSmartCart from "./PremiumSmartCart";
import PremiumProductGrid from "./PremiumProductGrid_Enhanced";

function App() {
  const [currentView, setCurrentView] = useState('home');
  const [showAnalyticsDashboard, setShowAnalyticsDashboard] = useState(false);
  const [showEnhancedAnalytics, setShowEnhancedAnalytics] = useState(false);
  const [showAdvancedSearch, setShowAdvancedSearch] = useState(false);
  const [showSmartShoppingCart, setShowSmartShoppingCart] = useState(false);
  const [showEnhancedAR, setShowEnhancedAR] = useState(false);
  const [showVirtualAR, setShowVirtualAR] = useState(false);
  const [showARShowcase, setShowARShowcase] = useState(false);
  const [selectedProduct, setSelectedProduct] = useState(null);
  const [searchQuery, setSearchQuery] = useState('');
  const [showChatbot, setShowChatbot] = useState(false);
  
  // Premium Mobile States
  const [showPremiumCart, setShowPremiumCart] = useState(false);
  const [cartItems, setCartItems] = useState([]);
  const [isMobileView, setIsMobileView] = useState(window.innerWidth <= 768);

  // Responsive detection
  useEffect(() => {
    const handleResize = () => {
      setIsMobileView(window.innerWidth <= 768);
    };
    
    window.addEventListener('resize', handleResize);
    return () => window.removeEventListener('resize', handleResize);
  }, []);

  // Mobile handlers
  const handleAddToCart = (product) => {
    setCartItems(prev => {
      const existing = prev.find(item => item.id === product.id);
      if (existing) {
        return prev.map(item => 
          item.id === product.id 
            ? { ...item, quantity: item.quantity + 1 }
            : item
        );
      }
      return [...prev, { ...product, quantity: 1 }];
    });
    
    // Show success notification
    console.log(`‚úÖ ${product.name} added to cart!`);
  };

  const handleCartOpen = () => {
    if (isMobileView) {
      setShowPremiumCart(true);
    } else {
      setShowSmartShoppingCart(true);
    }
  };

  const handleSearchOpen = () => {
    setShowAdvancedSearch(true);
  };

  // Enhanced Homepage with Premium Mobile Experience
  const HomePage = () => {
    // Demo product for AR testing
    const demoProduct = {
      id: 1,
      name: "Premium Smart Watch",
      description: "Advanced fitness tracking with AI health insights",
      price: 299.99,
      image_url: "https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=600&h=600&fit=crop",
      images: [
        "https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=600&h=600&fit=crop",
        "https://images.unsplash.com/photo-1434493789847-2f02dc6ca35d?w=600&h=600&fit=crop",
        "https://images.unsplash.com/photo-1508685096489-7aacd43bd3b1?w=600&h=600&fit=crop"
      ],
      colors: [
        {'name': 'Space Gray', 'hex': '#4a5568', 'price_modifier': 0},
        {'name': 'Rose Gold', 'hex': '#ed8936', 'price_modifier': 50},
        {'name': 'Silver', 'hex': '#cbd5e0', 'price_modifier': 25},
        {'name': 'Ocean Blue', 'hex': '#2b6cb0', 'price_modifier': 30}
      ],
      sizes: [
        {'size': '38mm', 'price_modifier': 0},
        {'size': '42mm', 'price_modifier': 50},
        {'size': '45mm', 'price_modifier': 100}
      ]
    };

    // Mobile-first responsive layout
    if (isMobileView) {
      return (
        <div className="premium-homepage">
          <MobileHeader 
            onCartOpen={handleCartOpen}
            onSearchOpen={handleSearchOpen}
            cartItemCount={cartItems.length}
          />
          
          <div className="premium-content" style={{ 
            paddingTop: '80px',
            paddingBottom: '80px'
          }}>
            <PremiumProductGrid 
              onAddToCart={handleAddToCart}
              onARPreview={(product) => {
                setSelectedProduct(product);
                setShowVirtualAR(true);
              }}
              onShowAR={(product) => {
                setSelectedProduct(product);
                setShowVirtualAR(true);
              }}
            />
          </div>
          
          <MobileNavigation 
            currentView={currentView}
            setCurrentView={(view) => {
              setCurrentView(view);
              if (view === 'cart') handleCartOpen();
              if (view === 'search') handleSearchOpen();
            }}
            cartItems={cartItems}
          />
        </div>
      );
    }

    // Desktop layout (existing design)
    return (
    <div className="walmart-homepage">
      {/* Professional Header */}
      <header className="hero-header">
        <div className="header-container">
          <div className="logo-section">
            <div className="walmart-logo">
              <span className="logo-icon">üõçÔ∏è</span>
              <span className="logo-text">RetailFlow AI</span>
            </div>
            <div className="tagline">Powered by Walmart Innovation</div>
          </div>
          <nav className="main-navigation">
            <img 
              src="https://cdn-icons-png.flaticon.com/128/9198/9198132.png"
              alt="Navigation Icon"
              className="nav-icon"
              style={{
                width: '32px',
                height: '32px',
                marginRight: '15px',
                filter: 'drop-shadow(0 2px 4px rgba(0,0,0,0.2))',
                transition: 'all 0.3s ease'
              }}
              onError={(e) => {
                e.target.style.display = 'none';
              }}
            />
            <button className="nav-btn active">Home</button>
            <button className="nav-btn" onClick={() => setCurrentView('walmart-admin')}>Products</button>
            <button className="nav-btn" onClick={() => {
              setSelectedProduct(demoProduct);
              setShowVirtualAR(true);
            }}>AR Demo</button>
            <button className="nav-btn" onClick={() => setShowAnalyticsDashboard(true)}>Analytics</button>
            <button className="nav-btn" onClick={() => setShowChatbot(true)}>AI Assistant</button>
            <MiniSearch 
              onSearch={(query) => {
                setSearchQuery(query);
                setShowAdvancedSearch(true);
              }}
              onExpand={() => setShowAdvancedSearch(true)}
            />
          </nav>
        </div>
      </header>

      {/* Hero Section */}
      <section className="hero-section">
        <div className="hero-container">
          {/* Left Side - Content */}
          <div className="hero-content">
            {/* Hero badge removed as requested */}
            
            <h1 className="hero-title">
              The Future of
              <span className="gradient-text"> Retail Shopping</span>
              <br />is Here
            </h1>
            
            <p className="hero-description">
              Experience revolutionary AI-powered shopping with natural conversation, 
              intelligent mood detection, and professional AR try-on technology. 
              Transform how customers discover and interact with products.
            </p>
            
            <div className="hero-stats">
              <div className="stat-item">
                <div className="stat-number">95%</div>
                <div className="stat-label">Customer Satisfaction</div>
              </div>
              <div className="stat-item">
                <div className="stat-number">3x</div>
                <div className="stat-label">Faster Product Discovery</div>
              </div>
              <div className="stat-item">
                <div className="stat-number">AI</div>
                <div className="stat-label">Powered Recommendations</div>
              </div>
            </div>
            <div className="hero-actions">
              <button 
                className="primary-btn technical-btn"
                onClick={() => setShowChatbot(true)}
              >
                <div className="btn-content">
                  <span className="btn-icon">ü§ñ</span>
                  <div className="btn-text-wrapper">
                    <span className="btn-text">AI Assistant</span>
                    <span className="btn-subtext">Natural Language Processing</span>
                  </div>
                  <span className="btn-arrow">‚Üí</span>
                </div>
                <div className="btn-tech-overlay"></div>
              </button>
              
              <button 
                className="secondary-btn technical-btn"
                onClick={() => {
                  setSelectedProduct(demoProduct);
                  setShowEnhancedAR(true);
                }}
              >
                <div className="btn-content">
                  <span className="btn-icon">ü•Ω</span>
                  <div className="btn-text-wrapper">
                    <span className="btn-text">AR Experience</span>
                    <span className="btn-subtext">WebXR Technology</span>
                  </div>
                  <span className="btn-arrow">‚Üí</span>
                </div>
                <div className="btn-tech-overlay"></div>
              </button>
              
              <button 
                className="tertiary-btn technical-btn"
                onClick={() => setShowAdvancedSearch(true)}
              >
                <div className="btn-content">
                  <span className="btn-icon">üîç</span>
                  <div className="btn-text-wrapper">
                    <span className="btn-text">Smart Search</span>
                    <span className="btn-subtext">AI-Powered Discovery</span>
                  </div>
                  <span className="btn-arrow">‚Üí</span>
                </div>
                <div className="btn-tech-overlay"></div>
              </button>
            </div>
            
            {/* Corner Action Buttons */}
            <div className="corner-actions">
              <button 
                className="corner-btn image-left-top"
                onClick={() => setShowAnalyticsDashboard(true)}
                title="Analytics Dashboard"
              >
                <div className="corner-btn-icon">üìä</div>
                <div className="corner-btn-label">Analytics</div>
              </button>
              
              <button 
                className="corner-btn image-left-bottom"
                onClick={() => setCurrentView('walmart-admin')}
                title="Product Management"
              >
                <div className="corner-btn-icon">‚öôÔ∏è</div>
                <div className="corner-btn-label">Admin</div>
              </button>
              
              <button 
                className="corner-btn image-right-top"
                onClick={() => setShowSmartShoppingCart(true)}
                title="Smart Shopping Cart"
              >
                <div className="corner-btn-icon">üõí</div>
                <div className="corner-btn-label">Cart</div>
              </button>
              
              <button 
                className="corner-btn image-right-bottom"
                onClick={() => setShowARShowcase(true)}
                title="AR Products Showcase - HD Quality"
              >
                <div className="corner-btn-icon">ü•Ω</div>
                <div className="corner-btn-label">AR Showcase</div>
              </button>
            </div>
          </div>
          
          {/* Right Side - Visual */}
          <div className="hero-visual">
            <div className="visual-container">
              {/* Main Image */}
              <div className="main-image-wrapper">
                <img 
                  src="https://www.mashed.com/img/gallery/you-can-now-text-walmart-to-start-shopping/intro-1671475749.jpg"
                  alt="Walmart Text Shopping Experience - Modern Mobile Shopping"
                  className="main-image"
                  onError={(e) => {
                    e.target.src = "https://images.unsplash.com/photo-1563013544-824ae1b704d3?w=600&h=400&fit=crop&crop=center";
                    e.target.onerror = () => {
                      e.target.src = "https://images.unsplash.com/photo-1472851294608-062f824d29cc?w=600&h=400&fit=crop&crop=center";
                      e.target.onerror = () => {
                        e.target.src = "https://via.placeholder.com/600x400/0071ce/ffffff?text=Walmart+Shopping+Experience";
                      };
                    };
                  }}
                />
                <div className="image-overlay">
                  <div className="overlay-content">
                    {/* Tech badge removed as requested */}
                  </div>
                </div>
              </div>
              
            </div>
          </div>
        </div>
      </section>

      {/* Features Section */}
      <section className="features-section">
        <div className="features-container">
          <div className="section-header">
            <h2 className="section-title">Revolutionary Shopping Experience</h2>
            <p className="section-subtitle">
              Discover how our AI-powered platform transforms retail shopping
            </p>
          </div>
          
          <div className="features-grid">
            {/* Feature 1 */}
            <div 
              className="feature-card primary"
              onClick={() => setCurrentView('walmart-chatbot')}
            >
              <div className="feature-icon">ü§ñ</div>
              <h3 className="feature-title">Natural AI Conversation</h3>
              <p className="feature-description">
                Talk naturally! Say "party outfit" or "gym clothes" and our AI understands your mood and style preferences.
              </p>
              <div className="feature-highlight">
                <span className="highlight-text">Try Now</span>
                <span className="highlight-arrow">‚Üí</span>
              </div>
            </div>
            
            {/* Feature 2 */}
            <div 
              className="feature-card secondary"
              onClick={() => {
                setSelectedProduct(demoProduct);
                setShowEnhancedAR(true);
              }}
            >
              <div className="feature-icon">ü•Ω</div>
              <h3 className="feature-title">Professional AR Experience</h3>
              <p className="feature-description">
                Try on products virtually with realistic color changing, size selection, and 360¬∞ views. Test with our smart watch demo!
              </p>
              <div className="feature-highlight">
                <span className="highlight-text">Try AR Demo</span>
                <span className="highlight-arrow">‚Üí</span>
              </div>
            </div>
            
            {/* Feature 3 */}
            <div 
              className="feature-card tertiary"
              onClick={() => setShowAdvancedSearch(true)}
            >
              <div className="feature-icon">üîç</div>
              <h3 className="feature-title">Intelligent Smart Search</h3>
              <p className="feature-description">
                Advanced AI search that understands context, style, and preferences for perfect product matches.
              </p>
              <div className="feature-highlight">
                <span className="highlight-text">Search Now</span>
                <span className="highlight-arrow">‚Üí</span>
              </div>
            </div>
            
            {/* Feature 4 */}
            <div 
              className="feature-card quaternary"
              onClick={() => setShowSmartShoppingCart(true)}
            >
              <div className="feature-icon">üõí</div>
              <h3 className="feature-title">Smart Shopping Cart</h3>
              <p className="feature-description">
                Intelligent cart management with wishlist sync, price tracking, and personalized recommendations.
              </p>
              <div className="feature-highlight">
                <span className="highlight-text">View Cart</span>
                <span className="highlight-arrow">‚Üí</span>
              </div>
            </div>
            
            {/* Feature 5 */}
            <div 
              className="feature-card quinary"
              onClick={() => setShowEnhancedAnalytics(true)}
            >
              <div className="feature-icon">üìä</div>
              <h3 className="feature-title">Enhanced Analytics Dashboard</h3>
              <p className="feature-description">
                Advanced real-time insights with mood analytics, AI-powered trends, and comprehensive user behavior tracking.
              </p>
              <div className="feature-highlight">
                <span className="highlight-text">View Analytics</span>
                <span className="highlight-arrow">‚Üí</span>
              </div>
            </div>
            
            {/* Feature 6 */}
            <div className="feature-card senary">
              <div className="feature-icon">üéØ</div>
              <h3 className="feature-title">Mood-Based Recommendations</h3>
              <p className="feature-description">
                AI that understands your emotional context and suggests products that match your current needs.
              </p>
              <div className="feature-highlight">
                <span className="highlight-text">Coming Soon</span>
                <span className="highlight-arrow">‚ú®</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* Product Showcase */}
      <section className="product-showcase">
        <div className="showcase-container">
          <div className="showcase-header">
            <h2 className="showcase-title">Try Our AR Demo Experience</h2>
            <p className="showcase-subtitle">
              Experience the future of online shopping with our interactive AR try-on
            </p>
          </div>
          
          <div className="demo-product-card" onClick={() => {
            setSelectedProduct(demoProduct);
            setShowEnhancedAR(true);
          }}>
            <div className="product-image">
              <img 
                src={demoProduct.image_url}
                alt={demoProduct.name}
                onError={(e) => {
                  e.target.src = "https://via.placeholder.com/300x300/0071ce/ffffff?text=Smart+Watch";
                }}
              />
              <div className="ar-badge">
                <span className="ar-icon">ü•Ω</span>
                <span className="ar-text">Try in AR</span>
              </div>
            </div>
            <div className="product-info">
              <h3 className="product-name">{demoProduct.name}</h3>
              <p className="product-description">{demoProduct.description}</p>
              <div className="product-price">${demoProduct.price}</div>
              <div className="color-options">
                {demoProduct.colors.map((color, index) => (
                  <div 
                    key={index}
                    className="color-dot"
                    style={{ backgroundColor: color.hex }}
                    title={color.name}
                  ></div>
                ))}
              </div>
              <button className="try-ar-btn">
                <span className="btn-icon">üöÄ</span>
                <span className="btn-text">Launch AR Experience</span>
              </button>
            </div>
          </div>
        </div>
      </section>

      {/* Enhanced Walmart Pay Technology Section */}
      <section className="payment-tech-section">
        <div className="payment-container">
          <div className="section-header">
            <h2 className="section-title">Walmart Pay - Next Generation Payment Technology</h2>
            <p className="section-subtitle">
              The most advanced mobile payment solution designed exclusively for Walmart customers
            </p>
          </div>
          
          {/* Main Walmart Pay Card */}
          <div className="walmart-pay-showcase">
            <div className="walmart-pay-main-card">
              <div className="walmart-pay-header">
                <div className="walmart-logo-section">
                  <div className="walmart-pay-icon">üí≥</div>
                  <div className="walmart-branding">
                    <h2 className="walmart-pay-title">Walmart Pay</h2>
                    <p className="walmart-pay-tagline">Powered by AI & Blockchain Technology</p>
                  </div>
                </div>
                <div className="technology-badge">
                  <span className="tech-badge">üöÄ Next-Gen</span>
                </div>
              </div>
              
              <div className="walmart-pay-description">
                <p>
                  Experience the future of retail payments with our flagship mobile payment solution. 
                  Featuring AI-powered fraud detection, instant checkout, digital receipts, and exclusive 
                  Walmart rewards - all secured with military-grade encryption.
                </p>
              </div>
              
              <div className="walmart-pay-features-grid">
                <div className="feature-item premium">
                  <div className="feature-icon">‚ö°</div>
                  <div className="feature-content">
                    <h4>Lightning Fast Checkout</h4>
                    <p>AI-powered 1-click checkout with predictive cart filling</p>
                  </div>
                </div>
                
                <div className="feature-item premium">
                  <div className="feature-icon">üõ°Ô∏è</div>
                  <div className="feature-content">
                    <h4>Military-Grade Security</h4>
                    <p>Advanced blockchain encryption with biometric verification</p>
                  </div>
                </div>
                
                <div className="feature-item premium">
                  <div className="feature-icon">üéÅ</div>
                  <div className="feature-content">
                    <h4>Exclusive Walmart Rewards</h4>
                    <p>Earn points, cashback, and exclusive member-only discounts</p>
                  </div>
                </div>
                
                <div className="feature-item premium">
                  <div className="feature-icon">üì±</div>
                  <div className="feature-content">
                    <h4>Smart Digital Receipts</h4>
                    <p>AI-organized receipts with spending analytics and insights</p>
                  </div>
                </div>
                
                <div className="feature-item premium">
                  <div className="feature-icon">ü§ñ</div>
                  <div className="feature-content">
                    <h4>AI Fraud Protection</h4>
                    <p>Real-time fraud detection with machine learning algorithms</p>
                  </div>
                </div>
                
                <div className="feature-item premium">
                  <div className="feature-icon">üåê</div>
                  <div className="feature-content">
                    <h4>Global Walmart Network</h4>
                    <p>Works at all Walmart stores worldwide with seamless sync</p>
                  </div>
                </div>
              </div>
              
              <div className="walmart-pay-actions">
                <button className="walmart-pay-primary-btn">
                  <span className="btn-icon">üí≥</span>
                  <span className="btn-text">Set Up Walmart Pay</span>
                  <span className="btn-arrow">‚Üí</span>
                </button>
                
                <button className="walmart-pay-secondary-btn">
                  <span className="btn-icon">üì±</span>
                  <span className="btn-text">Download Walmart App</span>
                </button>
              </div>
            </div>
          </div>
          
          {/* Technology Showcase */}
          <div className="walmart-tech-showcase">
            <h3 className="tech-showcase-title">ÔøΩ Powered by Cutting-Edge Technology</h3>
            
            <div className="tech-features-grid">
              <div className="tech-feature-card">
                <div className="tech-icon">üß†</div>
                <h4>AI-Powered Intelligence</h4>
                <p>Machine learning algorithms for fraud detection, spending insights, and personalized offers</p>
              </div>
              
              <div className="tech-feature-card">
                <div className="tech-icon">üîó</div>
                <h4>Blockchain Security</h4>
                <p>Distributed ledger technology ensuring unhackable transaction security</p>
              </div>
              
              <div className="tech-feature-card">
                <div className="tech-icon">‚òÅÔ∏è</div>
                <h4>Cloud Infrastructure</h4>
                <p>Global cloud network for instant payments anywhere, anytime</p>
              </div>
              
              <div className="tech-feature-card">
                <div className="tech-icon">üìä</div>
                <h4>Real-Time Analytics</h4>
                <p>Live spending analytics, budget tracking, and savings recommendations</p>
              </div>
            </div>
          </div>
          
          {/* Enhanced Security Banner */}
          <div className="walmart-security-banner">
            <div className="security-content-enhanced">
              <div className="security-icon-large">üèõÔ∏è</div>
              <div className="security-text-enhanced">
                <h3>Bank-Level Security with Walmart Innovation</h3>
                <p>Your payments are protected by military-grade encryption, AI fraud detection, and Walmart's trusted security infrastructure used by millions of customers worldwide.</p>
              </div>
              <div className="security-badges-enhanced">
                <span className="security-badge premium">üîê 256-bit SSL</span>
                <span className="security-badge premium">üõ°Ô∏è PCI DSS Level 1</span>
                <span className="security-badge premium">ü§ñ AI Fraud Detection</span>
                <span className="security-badge premium">üîó Blockchain Secured</span>
                <span className="security-badge premium">üèÜ Walmart Trusted</span>
              </div>
            </div>
          </div>
          
          {/* Walmart Pay Benefits */}
          <div className="walmart-benefits-section">
            <h3 className="benefits-title">üéØ Why Choose Walmart Pay?</h3>
            
            <div className="benefits-grid">
              <div className="benefit-card">
                <div className="benefit-number">1</div>
                <h4>Fastest Checkout</h4>
                <p>Skip the lines with our AI-powered instant checkout technology</p>
              </div>
              
              <div className="benefit-card">
                <div className="benefit-number">2</div>
                <h4>Maximum Savings</h4>
                <p>Exclusive discounts and cashback offers only for Walmart Pay users</p>
              </div>
              
              <div className="benefit-card">
                <div className="benefit-number">3</div>
                <h4>Complete Security</h4>
                <p>Your financial data is protected by Walmart's enterprise-grade security</p>
              </div>
              
              <div className="benefit-card">
                <div className="benefit-number">4</div>
                <h4>Smart Features</h4>
                <p>AI-powered spending insights, budget tracking, and personalized recommendations</p>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
    );
  };

  return (
    <div className="App">
      {currentView === 'home' && <HomePage />}
      {currentView === 'chatbot' && <Chatbot />}
      {currentView === 'admin' && <Admin />}
      {currentView === 'walmart-admin' && (
        <WalmartAdmin 
          onBack={() => setCurrentView('home')} 
          onShowAR={(product) => {
            setSelectedProduct(product);
            setShowEnhancedAR(true);
          }}
        />
      )}
      {currentView === 'connection-test' && <ConnectionTest />}
      
      {/* Enhanced Chatbot - Opens as overlay */}
      {showChatbot && (
        <EnhancedChatbot 
          onClose={() => setShowChatbot(false)} 
          onShowAR={(product) => {
            setSelectedProduct(product);
            setShowEnhancedAR(true);
          }}
        />
      )}
      
      {showAnalyticsDashboard && (
        <AnalyticsDashboard onClose={() => setShowAnalyticsDashboard(false)} />
      )}
      
      {showEnhancedAnalytics && (
        <EnhancedAnalyticsDashboard onClose={() => setShowEnhancedAnalytics(false)} />
      )}
      
      {showAdvancedSearch && (
        <AdvancedSearch 
          isVisible={showAdvancedSearch}
          onClose={() => setShowAdvancedSearch(false)}
          onProductSelect={(product) => {
            setSelectedProduct(product);
            setShowAdvancedSearch(false);
          }}
          onShowAR={(product) => {
            setSelectedProduct(product);
            setShowEnhancedAR(true);
            setShowAdvancedSearch(false);
          }}
          initialSearchQuery={searchQuery}
        />
      )}
      
      {showSmartShoppingCart && (
        <SmartShoppingCart 
          isVisible={showSmartShoppingCart}
          onClose={() => setShowSmartShoppingCart(false)} 
          onShowAR={(product) => {
            setSelectedProduct(product);
            setShowEnhancedAR(true);
          }}
        />
      )}
      
      {showPremiumCart && (
        <PremiumSmartCart
          isVisible={showPremiumCart}
          onClose={() => setShowPremiumCart(false)}
          onShowAR={(product) => {
            setSelectedProduct(product);
            setShowEnhancedAR(true);
            setShowPremiumCart(false);
          }}
        />
      )}
      
      {showEnhancedAR && selectedProduct && (
        <EnhancedARViewer 
          product={selectedProduct} 
          onClose={() => {
            setShowEnhancedAR(false);
            setSelectedProduct(null);
          }} 
        />
      )}
      
      {/* Virtual AR Try-On */}
      {showVirtualAR && selectedProduct && (
        <VirtualARTryOn 
          product={selectedProduct} 
          onClose={() => {
            setShowVirtualAR(false);
            setSelectedProduct(null);
          }} 
        />
      )}
      
      {/* AR Products Showcase */}
      {showARShowcase && (
        <ARProductsShowcase 
          onClose={() => setShowARShowcase(false)}
        />
      )}
      
      {/* Only show footer on the home view */}
      {currentView === 'home' && <Footer />}
      
      {/* Floating Chatbot Button - Always visible */}
      {!showChatbot && (
        <button 
          className="floating-chatbot-btn"
          onClick={() => setShowChatbot(true)}
          title="Open AI Assistant"
        >
          ü§ñ
        </button>
      )}
    </div>
  );
}

export default App;
